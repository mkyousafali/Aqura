# GitHub Copilot Instructions for Aqura Management System

## ðŸ”„ Version Management Protocol

**CRITICAL: Every time you commit and push changes to git, you MUST update the version number.**

### Automatic Version Update Process:

1. **Before committing any changes**, run the version update script:
   ```bash
   # Use npm scripts (recommended)
   npm run version:patch    # For bug fixes and small improvements
   npm run version:minor    # For new features 
   npm run version:major    # For breaking changes
   
   # Or use direct script
   node scripts/update-version.js [patch|minor|major]
   ```
   This will automatically:
   - Increment version (2.0.2 â†’ 2.0.3)
   - Update root `package.json`
   - Update `frontend/package.json`
   - Update version display in `frontend/src/lib/components/Sidebar.svelte`
   - Update mobile version in `frontend/src/routes/mobile/+layout.svelte`

2. **Update version popup content manually** (REQUIRED):
   - Edit `frontend/src/lib/components/Sidebar.svelte` (lines ~610-650)
   - Update feature descriptions to match your changes
   - Update release date and version info
   - Use specific action words: "Fixed", "Implemented", "Enhanced", "Added"

3. **Then proceed with git operations**:
   ```bash
   git add -A
   git commit -m "feat: your feature description"
   git push origin master
   ```

### Version Update Guidelines:

- **Patch (x.x.X)**: Bug fixes, small improvements, styling changes, documentation updates
- **Minor (x.X.0)**: New features, component additions, significant enhancements, new modules
- **Major (X.0.0)**: Breaking changes, major architecture changes, API changes, complete rewrites

### Files That Display Version:

- `frontend/src/lib/components/Sidebar.svelte` - Desktop version footer and popup content
- `frontend/src/routes/mobile/+layout.svelte` - Mobile top bar version badge
- `package.json` - Root project version
- `frontend/package.json` - Frontend project version

### Integration Points:

The version number appears in:
1. **Desktop Sidebar Footer**: Shows version as "v2.0.2" with clickable popup
2. **Mobile Header Badge**: Shows version badge in top navigation
3. **Package Metadata**: Used for builds and deployments
4. **Version Popup**: Detailed release notes and feature descriptions

### Copilot Workflow Checklist:

Before every `git push`:
- [ ] Run `npm run version:[patch|minor|major]`
- [ ] Update version popup content in Sidebar.svelte
- [ ] Verify version updated in all 4 locations
- [ ] Test version display in both desktop and mobile interfaces
- [ ] Commit version changes with descriptive message
- [ ] Push to remote repository

### Error Handling:

If version update script fails:
1. Check if all target files exist
2. Verify file permissions
3. Ensure valid JSON syntax in package.json files
4. Check for merge conflicts in target files

### Manual Version Update (Fallback):

If script fails, manually update these files:
1. `/package.json` - "version" field
2. `/frontend/package.json` - "version" field  
3. `/frontend/src/lib/components/Sidebar.svelte` - Version footer and popup content
4. `/frontend/src/routes/mobile/+layout.svelte` - Mobile version badge

---

## ðŸŽ¯ Project Context

### Current Status: v2.0.2
- **Phase**: Development - Frontend foundation completed
- **Focus**: PWA-first windowed management platform for Saudi businesses
- **Target**: Bilingual (Arabic/English) enterprise management system

### Architecture:
- **Frontend**: SvelteKit + TypeScript + TailwindCSS + Vite PWA
- **Backend**: Go (Fiber framework) + Supabase (PostgreSQL + Auth + Storage)  
- **Deployment**: Vercel (Frontend) + Supabase (Backend)
- **Build Tools**: pnpm monorepo + Vite + PWA + Electron packaging
- **Package Manager**: pnpm (required - NOT npm/yarn)

### Development Environment:
```bash
# Install dependencies
pnpm setup  # or pnpm install

# Development servers  
pnpm dev  # Runs both frontend and backend
pnpm --filter frontend dev  # Frontend only (port 5173)

# Build commands
pnpm build  # Build all
pnpm build:pwa  # PWA build
pnpm build:windows  # Windows installer

# Utility commands
pnpm lint  # Lint all packages
pnpm test  # Run all tests  
pnpm i18n:extract  # Extract i18n strings
```

### Key Features Implemented:
- âœ… **Windowed Desktop Interface**: Drag/resize/minimize windows, taskbar, command palette
- âœ… **PWA Capabilities**: Installable, offline-first, service worker, push notifications
- âœ… **Bilingual System**: Arabic/English with RTL support and cultural adaptations
- âœ… **Business Modules**: HR Master, Branch Master, Vendor Master with CRUD operations
- âœ… **Accessibility**: WCAG 2.1 compliant, screen reader support, keyboard navigation
- âœ… **Security**: Supabase RLS, JWT auth, encrypted transmission

### Key Components:
- **Window Manager** (`windowManager`) - Desktop-style window management
- **Sidebar Navigation** - Multi-level navigation with submenus
- **i18n System** - Custom bilingual localization (not auto-translate)
- **PWA Features** - Service worker, offline support, installation
- **Data Management** - Supabase integration with offline sync
- **User Management** - Role-based access control

### UI/UX Guidelines:
- **Desktop-First**: Windowed interface with OS-style interactions
- **Mobile Responsive**: Touch-friendly mobile layouts
- **Bilingual**: Arabic RTL + English LTR with cultural adaptations
- **Accessibility**: ARIA labels, keyboard navigation, screen reader support
- **Color System**: Brand colors with consistent theming
- **Typography**: Noto Sans Arabic + Inter fonts

### Code Style Guidelines:
- **TypeScript**: Use for type safety, balanced typing (strict for domain, relaxed for UI)
- **Svelte Patterns**: Follow reactive patterns with Svelte stores
- **Error Handling**: Implement proper error handling with user feedback
- **Loading States**: Add loading states and user feedback for all async operations
- **Accessibility**: Use semantic HTML, ARIA labels, and keyboard navigation
- **Modularity**: Keep functions focused and modular
- **i18n**: Use custom i18n system (`import { t } from '$i18n'`)
- **Responsive**: Mobile-first responsive design with touch support

### Database Schema (Supabase):
- `users` - User accounts and profiles with RLS
- `vendors` - Vendor information and supplier relationships
- `branches` - Branch/location management for multi-site operations
- `receiving_records` - Receiving transaction data and audit trails
- `notifications` - System notifications and push messaging
- `employees` - HR employee records with departments
- Various junction tables for many-to-many relationships

### File Structure:
```
frontend/src/
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ components/          # Reusable UI components
â”‚   â”œâ”€â”€ stores/             # Svelte stores for state management
â”‚   â”œâ”€â”€ utils/              # Utility functions
â”‚   â”œâ”€â”€ types/              # TypeScript definitions
â”‚   â””â”€â”€ i18n/              # Custom bilingual system
â”œâ”€â”€ routes/                 # SvelteKit file-based routing
â”‚   â”œâ”€â”€ (desktop)/         # Desktop windowed interface
â”‚   â””â”€â”€ mobile/            # Mobile-optimized interface
â””â”€â”€ app.html               # HTML template
```

### Important Conventions:
- **Commits**: Use conventional commits (`feat:`, `fix:`, `docs:`, etc.)
- **Branches**: Work on `master` branch (single developer workflow)
- **Imports**: Use `$lib` alias for library imports
- **Styling**: TailwindCSS with custom design system
- **State**: Use Svelte stores for global state management
- **API**: Use Supabase client for data operations

Remember: Always maintain backward compatibility and provide migration paths for breaking changes!