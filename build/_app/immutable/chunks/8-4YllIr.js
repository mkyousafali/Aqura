var c=Object.defineProperty;var m=(d,i,t)=>i in d?c(d,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[i]=t;var o=(d,i,t)=>m(d,typeof i!="symbol"?i+"":i,t);import{w,d as l,g as r}from"./CE8Bg3hM.js";class h{constructor(){o(this,"windows",w(new Map));o(this,"activeWindowId",w(null));o(this,"nextZIndex",1001);o(this,"windowCounter",0);o(this,"windowList",l(this.windows,i=>Array.from(i.values()).sort((t,e)=>t.zIndex-e.zIndex)));o(this,"taskbarItems",l(this.windows,i=>Array.from(i.values()).map(t=>({windowId:t.id,title:t.title,icon:t.icon,isActive:t.isActive,isMinimized:t.state==="minimized"})).sort((t,e)=>t.title.localeCompare(e.title))));o(this,"activeWindow",l([this.windows,this.activeWindowId],([i,t])=>t&&i.get(t)||null))}openWindow(i){const t=i.id||`window-${++this.windowCounter}`;if(r(this.windows).has(t))return this.activateWindow(t),t;const s=this.calculateDefaultPosition(),n={id:t,title:i.title,component:i.component,props:i.props||{},icon:i.icon,position:i.position||s,size:i.size||{width:800,height:600},minSize:i.minSize||{width:400,height:300},maxSize:i.maxSize,resizable:i.resizable!==!1,minimizable:i.minimizable!==!1,maximizable:i.maximizable!==!1,closable:i.closable!==!1,modal:i.modal||!1,zIndex:this.nextZIndex++,state:"normal",isActive:!0,isDragging:!1,isResizing:!1};return this.windows.update(a=>(a.forEach(u=>u.isActive=!1),a.set(t,n),a)),this.activeWindowId.set(t),t}closeWindow(i){this.windows.update(t=>{const e=t.get(i);if(!e)return t;if(t.delete(i),e.isActive&&t.size>0){const s=Array.from(t.values()).filter(n=>n.state!=="minimized").sort((n,a)=>a.zIndex-n.zIndex)[0];s?(s.isActive=!0,this.activeWindowId.set(s.id)):this.activeWindowId.set(null)}else e.isActive&&this.activeWindowId.set(null);return t})}activateWindow(i){this.windows.update(t=>{const e=t.get(i);return e&&(t.forEach(s=>s.isActive=!1),e.isActive=!0,e.zIndex=this.nextZIndex++,e.state==="minimized"&&(e.state="normal"),this.activeWindowId.set(i)),t})}minimizeWindow(i){this.windows.update(t=>{const e=t.get(i);if(!e)return t;if(e.state="minimized",e.isActive=!1,r(this.activeWindowId)===i){const s=Array.from(t.values()).filter(n=>n.id!==i&&n.state!=="minimized").sort((n,a)=>a.zIndex-n.zIndex)[0];s?(s.isActive=!0,this.activeWindowId.set(s.id)):this.activeWindowId.set(null)}return t})}toggleMaximizeWindow(i){this.windows.update(s=>{const n=s.get(i);return n&&(n.state==="maximized"?n.state="normal":(n.state="maximized",n.zIndex=this.nextZIndex++,s.forEach(a=>a.isActive=!1),n.isActive=!0)),s});const e=r(this.windows).get(i);e&&e.state==="maximized"&&this.activeWindowId.set(i)}updateWindowPosition(i,t){this.windows.update(e=>{const s=e.get(i);return s&&(s.position=t),e})}updateWindowSize(i,t){this.windows.update(e=>{const s=e.get(i);return s&&(s.size=t),e})}setWindowDragging(i,t){this.windows.update(e=>{const s=e.get(i);return s&&(s.isDragging=t),e})}setWindowResizing(i,t){this.windows.update(e=>{const s=e.get(i);return s&&(s.isResizing=t),e})}closeAllWindows(){this.windows.set(new Map),this.activeWindowId.set(null)}minimizeAllWindows(){this.windows.update(i=>(i.forEach(t=>{t.state="minimized",t.isActive=!1}),this.activeWindowId.set(null),i))}calculateDefaultPosition(){const t=r(this.windows).size*30;return{x:100+t%300,y:100+t%200}}getWindow(i){return r(this.windows).get(i)||null}hasModalWindows(){return Array.from(r(this.windows).values()).some(i=>i.modal&&i.state!=="minimized")}get windows$(){return this.windows}get activeWindowId$(){return this.activeWindowId}}const W=new h;export{W as w};
//# sourceMappingURL=8-4YllIr.js.map
